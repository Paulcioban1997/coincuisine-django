
{% extends 'recipes/recettes/base.html' %}
{% load i18n %}
{% load recette_extras %}

{% block content %}
  <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 18px;">
    <h1 style="color: #ff8700; margin-bottom: 0;">{% trans "Liste des Recettes" %}</h1>
    <form method="get" action="" style="display: flex; align-items: center; gap: 6px;">
      <input type="text" name="q" placeholder="{% trans 'Rechercher...' %}" class="form-control" style="max-width: 180px; border-radius: 20px;">
      <button type="submit" class="btn" style="background: #ff8700; color: #fff; border-radius: 50%; padding: 6px 10px;">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
          <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001l3.85 3.85a1 1 0 0 0 1.415-1.415l-3.85-3.85zm-5.242 1.106a5.5 5.5 0 1 1 0-11 5.5 5.5 0 0 1 0 11z"/>
        </svg>
      </button>
    </form>
  </div>
  <div class="row" style="background-color: #ffefe0; border-radius: 12px; padding: 30px 10px 10px 10px;">
    {% for recette in recettes %}
      <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-3">
        <a href="{% url 'recipe_detail' recette.pk %}" style="text-decoration: none; color: inherit;">
          <div class="card h-100" style="background: #fafafa; border: 1px solid #e0e0e0; border-radius: 10px; box-shadow: 0 2px 6px #0001; transition: box-shadow 0.2s;">
            {% if recette.title|lower == 'burger le cheval à 600hp' or recette.title|lower == 'burger le cheval a 600hp' %}
              <img src="/media/recettes/Burger_Cheval_600HP.png" class="card-img-top" alt="{% trans 'Burger le Cheval à 600HP' %}" style="object-fit:cover; height:120px; width:100%; border-radius: 10px 10px 0 0;">
            {% elif recette.title|lower == 'poutine' %}
              <img src="/media/recettes/poutine_image.jpg" class="card-img-top" alt="{% trans 'Poutine' %}" style="object-fit:cover; height:120px; width:100%; border-radius: 10px 10px 0 0;">
            {% elif recette.title|lower == 'burger' %}
              <img src="/media/recettes/Burger_image.jpg" class="card-img-top" alt="Burger" style="object-fit:cover; height:120px; width:100%; border-radius: 10px 10px 0 0;">
            {% elif recette.image %}
              <img src="{{ recette.image.url }}" class="card-img-top" alt="{{ recette.title }}" style="object-fit:cover; height:120px; width:100%; border-radius: 10px 10px 0 0;">
            {% else %}
              <img src="https://via.placeholder.com/200x120?text=Pas+de+photo" class="card-img-top" alt="Pas de photo" style="object-fit:cover; height:120px; width:100%; border-radius: 10px 10px 0 0;">
            {% endif %}
            <div class="card-body" style="padding: 10px;">
              <h5 class="card-title" style="font-size: 1.1em; color: #333;">{{ recette.title }}
                {% if recette.title|lower == 'poutine' %}<span class="badge bg-success ms-2">9.99&nbsp;$</span>{% endif %}
                {% if 'burger' in recette.title|lower and '600hp' in recette.title|lower %}<span class="badge bg-success ms-2">12.99&nbsp;$</span>{% endif %}
                {% if recette.title|lower == 'burger' %}<span class="badge bg-success ms-2">12.99&nbsp;$</span>{% endif %}

                {# Miniature de l'image à côté du titre #}
                {% if recette.title|lower == 'burger le cheval à 600hp' or recette.title|lower == 'burger le cheval a 600hp' %}
                  <img src="/media/recettes/Burger_Cheval_600HP.png" alt="{% trans 'Burger le Cheval à 600HP' %}" style="height:22px; width:32px; object-fit:cover; border-radius:4px; margin-left:6px; vertical-align:middle;">
                {% elif recette.title|lower == 'poutine' %}
                  <img src="/media/recettes/poutine_image.jpg" alt="{% trans 'Poutine' %}" style="height:22px; width:32px; object-fit:cover; border-radius:4px; margin-left:6px; vertical-align:middle;">
                {% elif recette.title|lower == 'burger' %}
                  <img src="/media/recettes/Burger_image.jpg" alt="Burger" style="height:22px; width:32px; object-fit:cover; border-radius:4px; margin-left:6px; vertical-align:middle;">
                {% elif recette.image %}
                  <img src="{{ recette.image.url }}" alt="{{ recette.title }}" style="height:22px; width:32px; object-fit:cover; border-radius:4px; margin-left:6px; vertical-align:middle;">
                {% else %}
                  <img src="https://via.placeholder.com/32x22?text=+" alt="Pas de photo" style="height:22px; width:32px; object-fit:cover; border-radius:4px; margin-left:6px; vertical-align:middle;">
                {% endif %}
              </h5>
              <p class="card-text" style="font-size: 0.95em; color: #666;">{{ recette.description|truncatechars:70 }}</p>
              <div class="mb-2">
                {% for i in "12345" %}
                  {% if i|to_int <= recette.rating %}
                    <span style="color: gold; font-size: 1em;">&#9733;</span>
                  {% else %}
                    <span style="color: #bbb; font-size: 1em;">&#9733;</span>
                  {% endif %}
                {% endfor %}
              </div>
              {# Commentaires label removed from menu/list view as requested #}
            </div>
          </div>
        </a>
      </div>
    {% empty %}
      <div class="col-12"><p>Aucune recette trouvée.</p></div>
    {% endfor %}
  </div>
{% endblock %}